local a=require("basalt")local b={}local c="bank"local d;while not d do d=rednet.lookup(c,"bankController")print("No Bankserver found! Retrying in 1 second...")sleep(1)end;function b.balance(e,f)rednet.send(d,{atmNumber=os.getComputerID(),type="balance",acc=e,pin=f},c)local g,h=rednet.receive("bank",5)if not h then error("Failed to contact the server!")elseif h.error then if h.error=="Incorrect Pin"then error("Error: Incorrect PIN entered.")else error(h.error)end end;return h.balance end;function b.deposit(e,i,f)rednet.send(d,{atmNumber=os.getComputerID(),type="deposit",acc=e,ids=i,pin=f},c)local g,h=rednet.receive("bank",10)if not h then error("Failed to contact the server!")elseif h.error then if h.error=="Incorrect Pin"then error("Error: Incorrect PIN entered.")else error(h.error)end end;return h.balance end;function b.withdraw(e,j,f)rednet.send(d,{atmNumber=os.getComputerID(),type="withdraw",acc=e,amount=j,pin=f},c)local g,h=rednet.receive("bank",10)if not h then error("Failed to contact the server!")elseif h.error then if h.error=="Incorrect Pin"then error("Error: Incorrect PIN entered.")elseif h.error=="Insufficient Funds"then error("Error: Not enough funds to complete the transaction.")else error(h.error)end end;return h.balance,h.ids end;function b.transfer(e,k,j,f)rednet.send(d,{atmNumber=os.getComputerID(),type="transfer",acc=e,amount=j,targetAcc=k,pin=f},c)local g,h=rednet.receive("bank",5)if not h then error("Failed to contact the server!")elseif h.error then if h.error=="Incorrect Pin"then error("Error: Incorrect PIN entered.")else error(h.error)end end;return h.balance end;function b.checkPin(e,f)rednet.send(d,{atmNumber=os.getComputerID(),type="checkPin",acc=e,pin=f},c)local g,h=rednet.receive("bank",5)if h then return h.status else error("Failed to contact the server!")end end;function b.existsAccount(e)rednet.send(d,{atmNumber=os.getComputerID(),type="checkCard",acc=e},c)local g,h=rednet.receive("bank",5)if h then return h.status else error("Failed to contact the server!")end end;return b
