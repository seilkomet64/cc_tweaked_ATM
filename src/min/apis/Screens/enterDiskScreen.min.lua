local a=require("basalt")local b=require("atmAPI")local c=nil;local d=nil;local function e()local f=peripheral.find("drive")if not f then error("No Drive found!")end;if not f.isDiskPresent()then os.pullEvent("disk")end;if not c or not d then return end;d:setText("Card Detected! Checking for matches...")local g,h=pcall(function()return b.existsAccount(f.getDiskID())end)if not g then local i=h:match(":%d+: (.+)")or h;if i=="Failed to contact the server!"then d:setText("Server not reachable. Please try again later."):setForeground(colors.red)else d:setText("An error occurred: "..i):setForeground(colors.red)end elseif h then ChangeScreen(SCREENS.mainScreen,nil,{acc=f.getDiskID()})else d:setText("This Credit Card is not registered at our Bank!\nVisit the Bank to create a new Account!"):setForeground(colors.red)end;os.pullEvent("disk_eject")if d then d:setText("Enter your Credit Card to continue!"):setForeground(colors.black)end;e()end;return function()c=a.createFrame()if not c then error("Something went wrong creating the Main Frame")end;d=c:addLabel():setText("Enter your Credit Card to continue!"):setPosition("parent.w / 2 - self.w / 2 + 1","parent.h / 2")local j=c:addThread()j:start(e)return c end
